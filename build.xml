<?xml version="1.0" encoding="ISO-8859-1"?>

<project name="jniInchi" basedir="." default="compileAll" xmlns:cpptasks="antlib:org.sf.net.antcontrib.cpptasks">
	
	<property name="cml.jar" value="/jars/jumbo52.jar"/>
	<property name="xom.jar" value="/jars/xom-1.1.jar"/>
	<property name="cdk.jar" value="/jars/cdk-20060714.jar"/>
	
	<property name="bin.dir" value="bin"/>
	<property name="dist.dir" value="dist"/>
	<property name="doc.dir" value="javadoc"/>
	<property name="cpp.dir" value="cpp-bin"/>
	<property name="inchi.dir" value="inchi"/>
	
	<property name="jniInchi.src.dir" value="jni-inchi-wrapper/src"/>
	<property name="cdkWrapper.src.dir" value="cdk-inchi-generator/src"/>
	<property name="cmlWrapper.src.dir" value="cml-inchi-generator/src"/>
	
	<target name="init">
    	<!-- Create the time stamp -->
		<tstamp/>
		<!-- Create the build directory structure used by compile -->
		<mkdir dir="${bin.dir}"/>
	</target>
	
	<target name="clean" description="Delete all generated files">
		<delete dir="${bin.dir}" failonerror="false"/>
		<delete dir="${doc.dir}" failonerror="false"/>
	</target>
	
	<target name="compileJniInchi" description="Compiles jniInchi" depends="init">
		<echo>COMPILING: jniInchi Java</echo>
		<javac srcdir="${jniInchi.src.dir}/net/sf/jniinchi" destdir="${bin.dir}" source="1.4">
		    <include name="*.java" />
		</javac>
		
		<copy todir="${bin.dir}">
			<fileset dir="${cpp.dir}">
				<include name="JniInchi.dll"/>
				<include name="libJniInchi.so"/>
			</fileset>
		</copy>
		
		<copy todir="${bin.dir}" file="${inchi.dir}/libinchi.dll"/>
		<copy tofile="${bin.dir}/libinchi.so.1" file="${inchi.dir}/libinchi.so"/>
		
	</target>
	
	<target name="compileCmlWrapper" depends="compileJniInchi">
		<echo>COMPILING: CML Wrapper</echo>
		<javac srcdir="${cmlWrapper.src.dir}/net/sf/jniinchi/cml" destdir="${bin.dir}" source="1.5">
		    <include name="*.java" />
			<classpath>
				<pathelement location="${cml.jar}"/>
				<pathelement location="${xom.jar}"/>
			</classpath>
		</javac>
	</target>
	
	<target name="compileCdkWrapper" depends="compileJniInchi">
		<echo>COMPILING: CDK Wrapper</echo>
		<javac srcdir="${cdkWrapper.src.dir}/net/sf/jniinchi/cdk" destdir="${bin.dir}" source="1.5">
		    <include name="*.java" />
			<classpath>
				<pathelement location="${cdk.jar}"/>
			</classpath>
		</javac>
	</target>
	
	<target name="compileAll" depends="compileJniInchi,compileCmlWrapper,compileCdkWrapper"/>
	
	<target name="jar" depends="compileAll">
		<mkdir dir="${dist.dir}"/>
		<jar destfile="${dist.dir}/jniInchi.jar" basedir="${bin.dir}"/>
	</target>
	
	<target name="javadoc">
		<mkdir dir="${doc.dir}"/>
		<javadoc
			destdir="${doc.dir}"
			packagenames="sea36.inchitools.jni.*"
			>
			
			<sourcepath>
				<pathelement path="${jniInchi.src.dir}"/>
				<pathelement path="${cmlWrapper.src.dir}"/>
				<pathelement path="${cdkWrapper.src.dir}"/>
			</sourcepath>
			
			<classpath>
				<pathelement location="${cml.jar}"/>
				<pathelement location="${xom.jar}"/>
				<pathelement location="${cdk.jar}"/>
			</classpath>
		</javadoc>
	</target>
	
</project>